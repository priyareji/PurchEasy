{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/91799/Documents/project/PURCHeasy/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { __decorate, __param } from \"tslib\";\nimport { Component, Inject, ViewChild, ViewContainerRef, isDevMode } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nlet PopupComponent = class PopupComponent {\n  constructor(dialogRef, data = {}, gfService, locale, cdref, controlService, globalApiService, productCategoryApiService, appInit, injector) {\n    this.dialogRef = dialogRef;\n    this.data = data;\n    this.gfService = gfService;\n    this.locale = locale;\n    this.cdref = cdref;\n    this.controlService = controlService;\n    this.globalApiService = globalApiService;\n    this.productCategoryApiService = productCategoryApiService;\n    this.appInit = appInit;\n    this.injector = injector;\n    this.loader = true;\n    this.submitDisable = false;\n    this.popupLoader = false;\n    this.formFields = [];\n    this.config = {\n      fxFlex: 100\n    };\n    this.isDev = isDevMode();\n    this.addScrollClass = false;\n\n    if (!navigator.onLine) {\n      this.dialogRef.close();\n    }\n\n    this.injectService();\n  }\n\n  set focus(buttonContainer) {\n    if (buttonContainer && this.data.action === 'alert') {\n      setTimeout(() => {\n        if (Array.isArray(this.data.buttons)) {\n          const childButtons = buttonContainer.nativeElement.children;\n\n          for (let i = 0; i < childButtons.length; i++) {\n            if (childButtons[i].autofocus) {\n              childButtons[i].focus();\n              break;\n            }\n          }\n        }\n      }, 100);\n    }\n  }\n\n  injectService() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const service = yield import('@app/shared/services/base.service');\n      _this.baseService = _this.injector.get(service.BaseService);\n    })();\n  }\n\n  ngOnInit() {\n    return _asyncToGenerator(function* () {})();\n  }\n\n  ngAfterViewInit() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      if (navigator.onLine) {\n        if (_this2.data.action === 'dynamic') {\n          setTimeout( /*#__PURE__*/_asyncToGenerator(function* () {\n            let data = [];\n\n            if (_this2.data.componentData) {\n              data = _this2.data.componentData;\n\n              if (typeof _this2.data.componentData === 'object' && !Array.isArray(_this2.data.componentData)) {\n                data = [_this2.data.componentData];\n              }\n            }\n\n            data = data.concat([{\n              variableName: 'popupRef',\n              value: _this2.dialogRef\n            }]);\n            _this2.componentReference = yield _this2.gfService.loadComponent(_this2.data.component, _this2.vcRef, data);\n\n            if (_this2.componentReference && _this2.componentReference.addScrollClassToPopup) {\n              _this2.addScrollClass = true;\n            }\n\n            _this2.loader = false;\n          }));\n        } else if (_this2.data.action === 'filter') {\n          _this2.form = _this2.controlService.formGroupBuilder(_this2.data.fieldList);\n          _this2.formObject = {\n            form: _this2.form,\n            fields: _this2.data.fieldList\n          };\n          let subscribe;\n\n          const productCategoryField = _this2.data.fieldList.find(items => items.fieldColumn === 'productCategoryID');\n\n          if (productCategoryField && navigator.onLine) {\n            _this2.form.controls.productCategoryID.valueChanges.subscribe(controlResp => {\n              if (subscribe && !subscribe['closed']) {\n                subscribe.unsubscribe();\n              }\n\n              if (_this2.clearTimeout) {\n                clearTimeout(_this2.clearTimeout);\n              }\n\n              _this2.clearTimeout = setTimeout(() => {\n                if (controlResp && typeof controlResp === 'string') {\n                  const apiData = {\n                    searchString: controlResp\n                  };\n                  const header = {};\n                  let selectedValue = [];\n\n                  if (productCategoryField.selectedValue.length) {\n                    productCategoryField.selectedValue.map(items => {\n                      if (items.isAdd && !items.isDelete) {\n                        selectedValue.push(items.key);\n                      }\n                    });\n                  }\n\n                  subscribe = _this2.productCategoryApiService.getParentCategoryLeafList(apiData, header).subscribe(response => {\n                    if (response && response.records.length) {\n                      if (selectedValue.length) {\n                        response.records = response.records.filter(items => {\n                          if (!selectedValue.includes(items.ID)) {\n                            return items;\n                          }\n                        });\n                      }\n\n                      productCategoryField.options = response.records.map(data => {\n                        return {\n                          key: data.ID,\n                          value: data.crumb\n                        };\n                      });\n                    } else {\n                      productCategoryField.options = [];\n                    }\n                  }, error => {\n                    _this2.gfService.errorHandler(error, {\n                      snackBar: {\n                        position: 'before'\n                      }\n                    });\n\n                    productCategoryField.options = [];\n                  });\n                } else {\n                  productCategoryField.options = [];\n                }\n              }, _this2.appInit.configuration.searchDelay);\n            });\n          }\n\n          _this2.loader = false;\n        } else if (_this2.data.action === 'alert') {\n          _this2.loader = false;\n\n          _this2.cdref.detectChanges(); // setTimeout(() => {\n          // \tif (Array.isArray(this.data.buttons)) {\n          // \t\tconst childButtons = this.buttonContainer.nativeElement.children;\n          // \t\tfor (let i = 0; i < childButtons.length; i++) {\n          // \t\t\tif (childButtons[i].autofocus) {\n          // \t\t\t\tchildButtons[i].focus();\n          // \t\t\t\tbreak;\n          // \t\t\t}\n          // \t\t}\n          // \t}\n          // }, 100);\n\n        }\n      }\n    })();\n  }\n\n  submit() {\n    if (navigator.onLine) {}\n  }\n\n  updatePreference() {\n    if (this.formObject && this.formObject.form) {\n      this.submitDisable = true;\n\n      if (this.formObject.form.valid) {\n        this.loader = true;\n        const formValue = this.gfService.fieldSubmitApiValueConstruct(this.formObject.form.getRawValue(), this.formObject.fields);\n        sessionStorage.setItem('locale', formValue.language);\n        this.locale.switchLanguage(formValue.language);\n        this.loader = false;\n        this.submitDisable = false;\n\n        if (this.gfService.sessionUser.resourceTypes) {\n          delete this.gfService.sessionUser.resourceTypes;\n        }\n\n        this.dialogRef.close();\n      }\n    }\n  }\n\n  formObjectReader(record) {\n    this.formObject = record;\n  } // routeWorkgroup() {\n  // \tif (navigator.onLine) {\n  // \t\tthis.dialogRef.close();\n  // \t\tconst queryParams: any = {\n  // \t\t\ttab: 'joined_workgroups',\n  // \t\t\tsend_request: 'active'\n  // \t\t};\n  // \t\tthis.gfService.routeNavigation('/workgroup', queryParams);\n  // \t}\n  // }\n\n\n  searchPeopleDetail(data) {\n    if (data && data.userID) {\n      this.baseService.userDetail(data.userID);\n    }\n  }\n\n  close(popupClose = false) {\n    if (navigator.onLine) {\n      // if (!popupClose && this.baseService.formView && !this.isDev && this.data.action !== 'alert') {\n      // \tthis.alertPopup();\n      // \treturn;\n      // }\n      if (this.componentReference && this.componentReference.dialogClose) {\n        this.componentReference.dialogClose();\n      } else {\n        this.dialogRef.close(this.dialogCloseData || 'close');\n      }\n\n      this.baseService.resourcePopupTriggered = false;\n    }\n  } // alertPopup() {\n  // \tconst dialogRef = this.popup.open(PopupComponent, {\n  // \t\tpanelClass: ['custom-panel'],\n  // \t\tautoFocus: false,\n  // \t\tdata: {\n  // \t\t\taction: 'alert',\n  // \t\t\tclasses: 'warning',\n  // \t\t\tpopup: true,\n  // \t\t\ticon: 'warning',\n  // \t\t\ttitle: this.locale.translate('close_form'),\n  // \t\t\tcontent: this.locale.translate('close_form_text'),\n  // \t\t\tbuttons: [\n  // \t\t\t\t{\n  // \t\t\t\t\ttype: 'main-action',\n  // \t\t\t\t\tcaption: this.locale.translate('yes'),\n  // \t\t\t\t\tkey: 'yes'\n  // \t\t\t\t},\n  // \t\t\t\t{\n  // \t\t\t\t\ttype: 'main-action-cancel',\n  // \t\t\t\t\tcaption: this.locale.translate('no'),\n  // \t\t\t\t\tkey: 'no',\n  // \t\t\t\t\tautoFocus: true\n  // \t\t\t\t}\n  // \t\t\t]\n  // \t\t},\n  // \t\tdisableClose: true,\n  // \t\tmaxWidth: '560px'\n  // \t});\n  // \tdialogRef.afterClosed().subscribe((resp) => {\n  // \t\tif (resp) {\n  // \t\t\tif (resp.key === 'yes') {\n  // \t\t\t\tthis.close(true);\n  // \t\t\t}\n  // \t\t}\n  // \t});\n  // }\n\n\n  buttonTrigger(data) {\n    this.dialogRef.close(data);\n  }\n\n  getFlexOptions() {\n    return '1 1 200px';\n  }\n\n  search() {\n    if (navigator.onLine) {\n      if (this.formObject && this.formObject.form) {\n        this.submitDisable = true;\n\n        if (this.formObject.form.valid) {\n          this.loader = true;\n          const formValue = this.gfService.fieldSubmitApiValueConstruct(this.formObject.form.getRawValue(), this.formObject.fields);\n          this.dialogRef.close(this.gfService.JSONMerge({\n            formValue\n          }, this.formObject));\n        } else {\n          this.gfService.fieldControlMarkAsTouched(this.formObject.fields, this.formObject.form);\n          this.submitDisable = false;\n        }\n      }\n    }\n  }\n\n  ngOnDestroy() {\n    if (this.data.triggerEl) {\n      const el = this.data.triggerEl['_elementRef'].nativeElement;\n      setTimeout(() => {\n        el.blur();\n      });\n    }\n\n    if (this.baseService.formView && this.data.action !== 'alert') {\n      this.baseService.formView = false;\n    }\n  }\n\n};\n\n__decorate([ViewChild('content', {\n  read: ViewContainerRef\n})], PopupComponent.prototype, \"vcRef\", void 0);\n\n__decorate([ViewChild('buttonContainer')], PopupComponent.prototype, \"focus\", null);\n\n__decorate([ViewChild('sample')], PopupComponent.prototype, \"sample\", void 0);\n\nPopupComponent = __decorate([Component({\n  selector: 'app-popup',\n  templateUrl: './popup.component.html',\n  styleUrls: ['./popup.component.scss'],\n  styles: []\n}), __param(1, Inject(MAT_DIALOG_DATA))], PopupComponent);\nexport { PopupComponent };","map":{"version":3,"sources":["C:\\Users\\91799\\Documents\\project\\PURCHeasy\\src\\app\\components\\popup\\popup.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit, Inject, AfterViewInit, ViewChild, ViewContainerRef, ComponentRef, OnDestroy, ElementRef, ChangeDetectorRef, Injector, isDevMode } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { GlobalFunctionService } from '@app/shared/services/global-function.service';\nimport { LocaleService } from '@app/shared/services/locale.service';\nimport { FormGroup } from '@angular/forms';\nimport { GlobalApiService } from '@app/shared/services/global-api.service';\nimport { AppInitService } from '@app/app-initializer.service';\nimport { BuilderService } from '@app/components/controls/utilities/services/builder.service';\nimport { ApiService as ProductCategoryApiService } from '@app/modules/product-category/utilities/services/api.service';\nimport { Subscription } from 'rxjs';\n\n@Component({\n\tselector: 'app-popup',\n\ttemplateUrl: './popup.component.html',\n\tstyleUrls: ['./popup.component.scss']\n})\nexport class PopupComponent implements OnInit, AfterViewInit, OnDestroy {\n\n\t@ViewChild('content', { read: ViewContainerRef })\n\tvcRef!: ViewContainerRef;\n\t@ViewChild('buttonContainer') set focus(buttonContainer: ElementRef) {\n\t\tif (buttonContainer && this.data.action === 'alert') {\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (Array.isArray(this.data.buttons)) {\n\t\t\t\t\tconst childButtons = buttonContainer.nativeElement.children;\n\t\t\t\t\tfor (let i = 0; i < childButtons.length; i++) {\n\t\t\t\t\t\tif (childButtons[i].autofocus) {\n\t\t\t\t\t\t\tchildButtons[i].focus();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t}\n\t};\n\t@ViewChild('sample') sample!: ElementRef;\n\n\tcomponentRef!: ComponentRef<any>;\n\tdialogCloseData: any;\n\tloader: boolean = true;\n\tformObject: any;\n\tform!: FormGroup;\n\tsubmitDisable = false;\n\tclearTimeout: any;\n\tpopupLoader = false;\n\tcomponentReference: any;\n\tformFields: any = [];\n\tconfig = { fxFlex: 100 };\n\tbaseService: any;\n\tisDev = isDevMode();\n\taddScrollClass = false;\n\n\tconstructor(\n\t\tpublic dialogRef: MatDialogRef<PopupComponent>,\n\t\t@Inject(MAT_DIALOG_DATA) public data: any = {},\n\t\tpublic gfService: GlobalFunctionService,\n\t\tpublic locale: LocaleService,\n\t\tprivate cdref: ChangeDetectorRef,\n\t\tprivate controlService: BuilderService,\n\t\tprivate globalApiService: GlobalApiService,\n\t\tprivate productCategoryApiService: ProductCategoryApiService,\n\t\tprivate appInit: AppInitService,\n\t\tprivate injector: Injector\n\t) {\n\t\tif (!navigator.onLine) {\n\t\t\tthis.dialogRef.close();\n\t\t}\n\t\tthis.injectService();\n\t}\n\n\tasync injectService() {\n\t\tconst service = await import('@app/shared/services/base.service');\n\t\tthis.baseService = this.injector.get(service.BaseService);\n\t}\n\n\tasync ngOnInit() {\n\t}\n\n\tasync ngAfterViewInit() {\n\t\tif (navigator.onLine) {\n\t\t\tif (this.data.action === 'dynamic') {\n\t\t\t\tsetTimeout(async () => {\n\t\t\t\t\tlet data = [];\n\t\t\t\t\tif (this.data.componentData) {\n\t\t\t\t\t\tdata = this.data.componentData;\n\t\t\t\t\t\tif (typeof this.data.componentData === 'object' && !Array.isArray(this.data.componentData)) {\n\t\t\t\t\t\t\tdata = [this.data.componentData];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdata = data.concat([{ variableName: 'popupRef', value: this.dialogRef }]);\n\t\t\t\t\tthis.componentReference = await this.gfService.loadComponent(this.data.component, this.vcRef, data);\n\t\t\t\t\tif (this.componentReference && this.componentReference.addScrollClassToPopup) {\n\t\t\t\t\t\tthis.addScrollClass = true;\n\t\t\t\t\t}\n\t\t\t\t\tthis.loader = false;\n\t\t\t\t});\n\t\t\t} else if (this.data.action === 'filter') {\n\t\t\t\tthis.form = this.controlService.formGroupBuilder(this.data.fieldList);\n\t\t\t\tthis.formObject = { form: this.form, fields: this.data.fieldList };\n\t\t\t\tlet subscribe: Subscription;\n\t\t\t\tconst productCategoryField = this.data.fieldList.find((items: any) => items.fieldColumn === 'productCategoryID');\n\t\t\t\tif (productCategoryField && navigator.onLine) {\n\t\t\t\t\tthis.form.controls.productCategoryID.valueChanges.subscribe((controlResp) => {\n\t\t\t\t\t\tif (subscribe && !subscribe['closed']) {\n\t\t\t\t\t\t\tsubscribe.unsubscribe();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this.clearTimeout) {\n\t\t\t\t\t\t\tclearTimeout(this.clearTimeout);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.clearTimeout = setTimeout(() => {\n\t\t\t\t\t\t\tif (controlResp && typeof controlResp === 'string') {\n\t\t\t\t\t\t\t\tconst apiData = {\n\t\t\t\t\t\t\t\t\tsearchString: controlResp\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tconst header: any = {};\n\t\t\t\t\t\t\t\tlet selectedValue: any[] = [];\n\t\t\t\t\t\t\t\tif (productCategoryField.selectedValue.length) {\n\t\t\t\t\t\t\t\t\tproductCategoryField.selectedValue.map((items: any) => {\n\t\t\t\t\t\t\t\t\t\tif (items.isAdd && !items.isDelete) {\n\t\t\t\t\t\t\t\t\t\t\tselectedValue.push(items.key);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tsubscribe = this.productCategoryApiService.getParentCategoryLeafList(apiData, header).subscribe(\n\t\t\t\t\t\t\t\t\t(response: any) => {\n\t\t\t\t\t\t\t\t\t\tif (response && response.records.length) {\n\t\t\t\t\t\t\t\t\t\t\tif (selectedValue.length) {\n\t\t\t\t\t\t\t\t\t\t\t\tresponse.records = response.records.filter(items => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (!selectedValue.includes(items.ID)) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn items;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tproductCategoryField.options = response.records.map((data) => {\n\t\t\t\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey: data.ID,\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: data.crumb\n\t\t\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tproductCategoryField.options = [];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t(error) => {\n\t\t\t\t\t\t\t\t\t\tthis.gfService.errorHandler(error, {\n\t\t\t\t\t\t\t\t\t\t\tsnackBar: {\n\t\t\t\t\t\t\t\t\t\t\t\tposition: 'before'\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tproductCategoryField.options = [];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tproductCategoryField.options = [];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, this.appInit.configuration.searchDelay);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tthis.loader = false;\n\t\t\t} else if (this.data.action === 'alert') {\n\t\t\t\tthis.loader = false;\n\t\t\t\tthis.cdref.detectChanges();\n\t\t\t\t// setTimeout(() => {\n\t\t\t\t// \tif (Array.isArray(this.data.buttons)) {\n\t\t\t\t// \t\tconst childButtons = this.buttonContainer.nativeElement.children;\n\t\t\t\t// \t\tfor (let i = 0; i < childButtons.length; i++) {\n\t\t\t\t// \t\t\tif (childButtons[i].autofocus) {\n\t\t\t\t// \t\t\t\tchildButtons[i].focus();\n\t\t\t\t// \t\t\t\tbreak;\n\t\t\t\t// \t\t\t}\n\t\t\t\t// \t\t}\n\t\t\t\t// \t}\n\t\t\t\t// }, 100);\n\t\t\t}\n\t\t}\n\t}\n\n\tsubmit() {\n\t\tif (navigator.onLine) {\n\t\t}\n\t}\n\n\tupdatePreference() {\n\t\tif (this.formObject && this.formObject.form) {\n\t\t\tthis.submitDisable = true;\n\t\t\tif (this.formObject.form.valid) {\n\t\t\t\tthis.loader = true;\n\t\t\t\tconst formValue = this.gfService.fieldSubmitApiValueConstruct(\n\t\t\t\t\tthis.formObject.form.getRawValue(),\n\t\t\t\t\tthis.formObject.fields\n\t\t\t\t);\n\t\t\t\tsessionStorage.setItem('locale', formValue.language);\n\t\t\t\tthis.locale.switchLanguage(formValue.language);\n\t\t\t\tthis.loader = false;\n\t\t\t\tthis.submitDisable = false;\n\t\t\t\tif (this.gfService.sessionUser.resourceTypes) {\n\t\t\t\t\tdelete this.gfService.sessionUser.resourceTypes;\n\t\t\t\t}\n\t\t\t\tthis.dialogRef.close();\n\t\t\t}\n\t\t}\n\t}\n\n\tformObjectReader(record: any) {\n\t\tthis.formObject = record;\n\t}\n\n\t// routeWorkgroup() {\n\t// \tif (navigator.onLine) {\n\t// \t\tthis.dialogRef.close();\n\t// \t\tconst queryParams: any = {\n\t// \t\t\ttab: 'joined_workgroups',\n\t// \t\t\tsend_request: 'active'\n\t// \t\t};\n\t// \t\tthis.gfService.routeNavigation('/workgroup', queryParams);\n\t// \t}\n\t// }\n\n\tsearchPeopleDetail(data: any) {\n\t\tif (data && data.userID) {\n\t\t\tthis.baseService.userDetail(data.userID);\n\t\t}\n\t}\n\n\tclose(popupClose: boolean = false) {\n\t\tif (navigator.onLine) {\n\t\t\t// if (!popupClose && this.baseService.formView && !this.isDev && this.data.action !== 'alert') {\n\t\t\t// \tthis.alertPopup();\n\t\t\t// \treturn;\n\t\t\t// }\n\n\t\t\tif (this.componentReference && this.componentReference.dialogClose) {\n\t\t\t\tthis.componentReference.dialogClose();\n\t\t\t} else {\n\t\t\t\tthis.dialogRef.close(this.dialogCloseData || 'close');\n\t\t\t}\n\t\t\tthis.baseService.resourcePopupTriggered = false;\n\t\t}\n\t}\n\n\t// alertPopup() {\n\t// \tconst dialogRef = this.popup.open(PopupComponent, {\n\t// \t\tpanelClass: ['custom-panel'],\n\t// \t\tautoFocus: false,\n\t// \t\tdata: {\n\t// \t\t\taction: 'alert',\n\t// \t\t\tclasses: 'warning',\n\t// \t\t\tpopup: true,\n\t// \t\t\ticon: 'warning',\n\t// \t\t\ttitle: this.locale.translate('close_form'),\n\t// \t\t\tcontent: this.locale.translate('close_form_text'),\n\t// \t\t\tbuttons: [\n\t// \t\t\t\t{\n\t// \t\t\t\t\ttype: 'main-action',\n\t// \t\t\t\t\tcaption: this.locale.translate('yes'),\n\t// \t\t\t\t\tkey: 'yes'\n\t// \t\t\t\t},\n\t// \t\t\t\t{\n\t// \t\t\t\t\ttype: 'main-action-cancel',\n\t// \t\t\t\t\tcaption: this.locale.translate('no'),\n\t// \t\t\t\t\tkey: 'no',\n\t// \t\t\t\t\tautoFocus: true\n\t// \t\t\t\t}\n\t// \t\t\t]\n\t// \t\t},\n\t// \t\tdisableClose: true,\n\t// \t\tmaxWidth: '560px'\n\t// \t});\n\t// \tdialogRef.afterClosed().subscribe((resp) => {\n\t// \t\tif (resp) {\n\t// \t\t\tif (resp.key === 'yes') {\n\t// \t\t\t\tthis.close(true);\n\t// \t\t\t}\n\t// \t\t}\n\t// \t});\n\t// }\n\n\n\tbuttonTrigger(data: any) {\n\t\tthis.dialogRef.close(data);\n\t}\n\n\tgetFlexOptions() {\n\t\treturn '1 1 200px';\n\t}\n\n\tsearch() {\n\t\tif (navigator.onLine) {\n\t\t\tif (this.formObject && this.formObject.form) {\n\t\t\t\tthis.submitDisable = true;\n\t\t\t\tif (this.formObject.form.valid) {\n\t\t\t\t\tthis.loader = true;\n\t\t\t\t\tconst formValue = this.gfService.fieldSubmitApiValueConstruct(\n\t\t\t\t\t\tthis.formObject.form.getRawValue(),\n\t\t\t\t\t\tthis.formObject.fields\n\t\t\t\t\t);\n\t\t\t\t\tthis.dialogRef.close(this.gfService.JSONMerge({\n\t\t\t\t\t\tformValue\n\t\t\t\t\t}, this.formObject));\n\t\t\t\t} else {\n\t\t\t\t\tthis.gfService.fieldControlMarkAsTouched(this.formObject.fields, this.formObject.form);\n\t\t\t\t\tthis.submitDisable = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tngOnDestroy() {\n\t\tif (this.data.triggerEl) {\n\t\t\tconst el: HTMLElement = this.data.triggerEl['_elementRef'].nativeElement;\n\t\t\tsetTimeout(() => {\n\t\t\t\tel.blur();\n\t\t\t});\n\t\t}\n\t\tif (this.baseService.formView && this.data.action !== 'alert') {\n\t\t\tthis.baseService.formView = false;\n\t\t}\n\n\t}\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}